(function(){var AndGate;var BufferGate;var Gate;var NandGate;var NorGate;var NotGate;var OrGate;var XnorGate;var XorGate;var __hasProp={}.hasOwnProperty;var __extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)if(__hasProp.call(parent,key))child[key]=parent[key];ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};Gate=function(_super){function Gate(numIns,numOuts){this.numIns=numIns;this.numOuts=numOuts;Gate.__super__.constructor.call(this,
this.numIns,this.numOuts,Gate)}__extends(Gate,_super);Gate.registerType=function(gateClass){return this.types.push(gateClass)};Gate.createGraphics=function(device){var bitmap;var box;var container;container=new createjs.Container;bitmap=new createjs.Bitmap(this.bitmap);bitmap.x=-$gateSize*0.5;bitmap.y=-$gateSize*0.5;container.addChild(bitmap);box=new createjs.Shape;box.graphics.beginFill(createjs.Graphics.getRGB(255,0,0));box.graphics.rect(0,0,$gateSize,$gateSize);box.x=-$gateSize*0.5;box.y=-$gateSize*
0.5;container.hitArea=box;return container};Gate.prototype.createDSL=function(){};Gate.inputs=function(gates){var gate;var socket;var sockets;if(gates)sockets=[].concat.apply([],function(){var _i;var _len;var _results;_results=[];for(_i=0,_len=gates.length;_i<_len;_i++){gate=gates[_i];_results.push(function(){var _j;var _len1;var _ref;var _results1;_ref=gate.inputSockets;_results1=[];for(_j=0,_len1=_ref.length;_j<_len1;_j++){socket=_ref[_j];if(!socket.connectedToGate(gates))_results1.push(socket)}return _results1}())}return _results}());
else sockets=$.grep(Socket.all,function(socket){return socket.type==="in"&&!socket.connectedToGate(gates)});return sockets};Gate.outs=function(gates){var gate;var socket$$0;var sockets;if(gates)sockets=[].concat.apply([],function(){var _i;var _len;var _results;_results=[];for(_i=0,_len=gates.length;_i<_len;_i++){gate=gates[_i];_results.push(function(){var _j;var _len1;var _ref;var _results1;_ref=gate.outputSockets;_results1=[];for(_j=0,_len1=_ref.length;_j<_len1;_j++){socket$$0=_ref[_j];if(socket$$0.isRealOutput())_results1.push(socket$$0)}return _results1}())}return _results}());
else sockets=$.grep(Socket.all,function(socket){return socket.isRealOutput()});return sockets};Gate.createDSL=function(){var concatenate;var gate;var inputs;var integratedCircuits;var main;var outs;var s;var socket;var _i$$0;var _len$$0;var _ref;inputs=this.inputs();outs=this.outs();integratedCircuits=[];if(Gate.all==null)return"circuit main()\nend";concatenate=function(items){return[].concat.apply([],items)};main="circuit main("+function(){var _i;var _len;var _results;_results=[];for(_i=0,_len=inputs.length;_i<
_len;_i++){s=inputs[_i];_results.push(s.name)}return _results}().unique().join(", ")+")\n";_ref=this.all;for(_i$$0=0,_len$$0=_ref.length;_i$$0<_len$$0;_i$$0++){gate=_ref[_i$$0];if(gate instanceof IntegratedCircuit){integratedCircuits.push(gate.name);integratedCircuits.push(concatenate(IntegratedDSL.getDependencies(gate.name)))}main+="  "+gate.createDSL()+"\n"}main+="  out "+function(){var _j;var _len1;var _results;_results=[];for(_j=0,_len1=outs.length;_j<_len1;_j++){socket=outs[_j];_results.push(socket.name)}return _results}().join(", ")+
"\n";main+="end";integratedCircuits=concatenate(integratedCircuits).reverse().unique().map(function(ic){return IntegratedDSL.getDSL(ic)}).join("\n\n");return integratedCircuits+(integratedCircuits!==""?"\n\n":"")+main};Gate.displayName="GATE";Gate.bitmap="";Gate.types=[];return Gate}(Device);AndGate=function(_super){function AndGate(){AndGate.__super__.constructor.call(this,2,1)}__extends(AndGate,_super);AndGate.prototype.createDSL=function(){var in1;var in2;var out;in1=this.inputSockets[0];in2=this.inputSockets[1];
out=this.outputSockets[0];return""+out.name+" \x3d "+in1.name+" * "+in2.name};AndGate.displayName="AND";AndGate.bitmap="/assets/images/and_gate.png";return AndGate}(Gate);OrGate=function(_super){function OrGate(){OrGate.__super__.constructor.call(this,2,1)}__extends(OrGate,_super);OrGate.prototype.createDSL=function(){var in1;var in2;var out;in1=this.inputSockets[0];in2=this.inputSockets[1];out=this.outputSockets[0];return""+out.name+" \x3d "+in1.name+" + "+in2.name};OrGate.displayName="OR";OrGate.bitmap=
"/assets/images/or_gate.png";return OrGate}(Gate);NotGate=function(_super){function NotGate(){NotGate.__super__.constructor.call(this,1,1)}__extends(NotGate,_super);NotGate.prototype.createDSL=function(){var in1;var out;in1=this.inputSockets[0];out=this.outputSockets[0];return""+out.name+" \x3d "+in1.name+"'"};NotGate.displayName="NOT";NotGate.bitmap="/assets/images/not_gate.png";return NotGate}(Gate);XorGate=function(_super){function XorGate(){XorGate.__super__.constructor.call(this,2,1)}__extends(XorGate,
_super);XorGate.prototype.createDSL=function(){var in1;var in2;var out;in1=this.inputSockets[0];in2=this.inputSockets[1];out=this.outputSockets[0];return""+out.name+" \x3d "+in1.name+" ^ "+in2.name};XorGate.displayName="XOR";XorGate.bitmap="/assets/images/xor_gate.png";return XorGate}(Gate);NandGate=function(_super){function NandGate(){NandGate.__super__.constructor.call(this,2,1)}__extends(NandGate,_super);NandGate.prototype.createDSL=function(){var in1;var in2;var out;in1=this.inputSockets[0];in2=
this.inputSockets[1];out=this.outputSockets[0];return""+out.name+" \x3d "+in1.name+" nand "+in2.name};NandGate.displayName="NAND";NandGate.bitmap="/assets/images/nand_gate.png";return NandGate}(Gate);NorGate=function(_super){function NorGate(){NorGate.__super__.constructor.call(this,2,1)}__extends(NorGate,_super);NorGate.prototype.createDSL=function(){var in1;var in2;var out;in1=this.inputSockets[0];in2=this.inputSockets[1];out=this.outputSockets[0];return""+out.name+" \x3d "+in1.name+" nor "+in2.name};
NorGate.displayName="NOR";NorGate.bitmap="/assets/images/nor_gate.png";return NorGate}(Gate);XnorGate=function(_super){function XnorGate(){XnorGate.__super__.constructor.call(this,2,1)}__extends(XnorGate,_super);XnorGate.prototype.createDSL=function(){var in1;var in2;var out;in1=this.inputSockets[0];in2=this.inputSockets[1];out=this.outputSockets[0];return""+out.name+" \x3d "+in1.name+" xnor "+in2.name};XnorGate.displayName="XNOR";XnorGate.bitmap="/assets/images/xnor_gate.png";return XnorGate}(Gate);
BufferGate=function(_super){function BufferGate(){BufferGate.__super__.constructor.call(this,1,1)}__extends(BufferGate,_super);BufferGate.prototype.createDSL=function(){var in1;var out;in1=this.inputSockets[0];out=this.outputSockets[0];return""+out.name+" \x3d "+in1.name};BufferGate.displayName="BUFF";BufferGate.bitmap="/assets/images/buffer_gate.png";return BufferGate}(Gate);Gate.registerType(AndGate);Gate.registerType(OrGate);Gate.registerType(NotGate);Gate.registerType(XorGate);Gate.registerType(NandGate);
Gate.registerType(NorGate);Gate.registerType(XnorGate);Gate.registerType(BufferGate)}).call(this);